our goal today is to devise a plan. we need a plan, because we need to implement CI/CD for this application. this will involve implementing an aws cdk project that will host several different stacks. the first stack will be responsible for the web front end infrastructure, such as s3, cloudfront, route53, etc. the second stack will be responsible for the "app api" back end infrastructure, which is vpc/subnets, load balancer, web servers (ecs fargate tasks), databases, etc. The third stack will be responsible for the "inference api" back end infrastructure, which will share the vpc, subnets, load balancer, etc from the second stack but also have sepearete definitions for ecs fargate tasks and images that will be hosted separately.
The fourth stack will contain the infrastructure for our agent core implementation. This is where our agent code will be deployed to the managed service in aws. the fifth stack will be responsible for our agentcore gateway and mcp server infrastructure.
each stack will leverage cloudformation outputs and parameter store, when appropriate, to supply information to other dependent stacks.

alongside the cdk infrastructure code, we will be creating a build and deployment pipeline. there are some very important criteria for this task. first, the application repo is hosted on github, and will leverage github actions as first class citizens for CI/CD. The rub, however, is that we want the build/deployment of this application to be platform agnostic. So, we will split the difference. Each step in the github actions that are created for this project will all rely on backing shell scripts, which are separate and accessible so that each script can be run independently of one another and on someones local compputer or other git repo like azure devops/gitlab. so, let me explain it one more time. The application will have complete build/deploy pipelines written in yaml for github actions. however, each step of each job in the aforementioned actions should reference a script file, also store in the repo, so that the scripts can be run outside of github actions as well.

Refer to the stack breakdown above to determine the number of pipelines to build. I'd like for each stack to have simple pipeline that includes build/test/deploy steps. it should also be assumed that the ci/cd pipelines will be running on the ubuntu-latest hosted agent on github...which means each pipeline should include steps for installing the required dependencies for each job.

After the pipeline files have been created, let's create a top-level script that can be used in an interactive manner to deploy any or all of the stacks of the application, all locally using the github actions' underlying shell scripts.

Your job is to create an intricate, detailed checklist called THE_PLAN.md. It will include all of the information that I have given you, but processed and organized into a natural plan that can be followed to achieve 100% of the original vision. You will also create a separate document called CLAUDES_INSTRUCTIONS.md. it will be an instruction document for the claude sonnet agent that will be performing the coding work. fill the agent in on the high level overview of the project, and remind the coding agent that it shouldnt create markdown files unless specifically told to do so. It is allowed to update the readme, but only to correct misinformation.the final output of this chat will be a file called PROMPT_TEMPLATE.md that will contain the perfect prompt that I should send to my claude agent, along with the context of THE_PLAN.md and CLAUDES_INSTRUCTIONS.md.